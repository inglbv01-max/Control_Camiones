<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Control de Camiones</title>
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>
  <!-- LOGIN -->
  <div id="login-screen" class="wrap">
    <h1>üöõ Control de Camiones</h1>
    <h3>Iniciar sesi√≥n</h3>
    <label>Usuario</label>
    <input type="text" id="username"/>
    <label>Contrase√±a</label>
    <input type="password" id="password"/>
    <button id="btnLogin" type="button" class="sync">Entrar</button>
    <span id="login-status" class="error"></span>
  </div>

  <!-- APP -->
  <div id="app-screen" class="wrap" style="display:none">
    <div class="top-bar">
      <button id="btnLogout" type="button" class="danger">Cerrar sesi√≥n</button>
      <span id="sync-status"></span>
    </div>

    <!-- NAV TABS -->
    <div class="tabs">
      <button type="button" class="tabbtn active" data-tab="viajes">Viajes</button>
      <button type="button" class="tabbtn" data-tab="camiones">Camiones</button>
      <button type="button" class="tabbtn" data-tab="ubicaciones">Ubicaciones / Lotes</button>
    </div>

    <!-- TAB VIAJES -->
    <section id="tab-viajes" class="card">
      <h3>üìã Registrar Viaje</h3>
      <div class="row">
        <div><label>Fecha</label><input id="fecha" type="date"/></div>
        <div><label>Cami√≥n</label><select id="camionSel"></select></div>
        <div><label>Placa</label><input id="placa" readonly/></div>
        <div><label>Origen</label><select id="origenSel"></select></div>
        <div><label>Destino</label><select id="destinoSel"></select></div>
        <div><label>Lote</label><select id="loteSel"></select></div>
        <div><label>Salida</label><input id="salida" type="time"/></div>
        <div><label>Llegada</label><input id="llegada" type="time"/></div>
      </div>
      <label>Observaciones</label>
      <textarea id="obs" rows="2" placeholder="Notas‚Ä¶"></textarea>

      <div class="btns">
        <button id="btnGuardar" type="button" class="save">Guardar</button>
        <button id="btnLimpiar" type="button" class="ghost">Limpiar</button>
        <button id="btnSync" type="button" class="sync">Sincronizar</button>
        <button id="btnPDF" type="button" class="pdf">PDF</button>
      </div>

      <div class="card">
        <h3>Viajes Guardados (offline)</h3>
        <table>
          <thead>
            <tr>
              <th>Fecha</th><th>Cami√≥n</th><th>Placa</th><th>Origen</th>
              <th>Destino</th><th>Lote</th><th>Salida</th><th>Llegada</th><th>Obs</th><th>Acci√≥n</th>
            </tr>
          </thead>
          <tbody id="tbodyViajes"></tbody>
        </table>
      </div>
    </section>

    <!-- TAB CAMIONES -->
    <section id="tab-camiones" class="card" style="display:none">
      <h3>üöö Cat√°logo de Camiones</h3>
      <div class="row">
        <div><label>Nombre Cami√≥n</label><input id="newCamion"/></div>
        <div><label>Placa</label><input id="newPlaca"/></div>
      </div>
      <div class="btns">
        <button id="btnAddCamion" type="button" class="save mini">Agregar</button>
      </div>
      <div class="card">
        <table>
          <thead><tr><th>Cami√≥n</th><th>Placa</th><th>Acci√≥n</th></tr></thead>
          <tbody id="tbodyCamiones"></tbody>
        </table>
      </div>
    </section>

    <!-- TAB UBICACIONES/LOTES -->
    <section id="tab-ubicaciones" class="card" style="display:none">
      <h3>üìå Cat√°logo de Ubicaciones / Lotes</h3>
      <div class="row">
        <div><label>Ubicaci√≥n</label><input id="newUbicacion"/></div>
        <div><label>Lote</label><input id="newLote"/></div>
      </div>
      <div class="btns">
        <button id="btnAddUbicacion" type="button" class="save mini">Agregar Ubicaci√≥n</button>
        <button id="btnAddLote" type="button" class="save mini">Agregar Lote</button>
      </div>
      <div class="card">
        <h4>Ubicaciones</h4>
        <ul id="listaUbicaciones"></ul>
        <h4>Lotes</h4>
        <ul id="listaLotes"></ul>
      </div>
    </section>

  </div>

  <script src="db.js"></script>
  <script src="app.js"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('SW registrado'))
        .catch(console.error);
    }

    // Manejo simple de tabs
    const tabs = document.querySelectorAll('.tabbtn');
    const sections = {
      viajes: document.getElementById('tab-viajes'),
      camiones: document.getElementById('tab-camiones'),
      ubicaciones: document.getElementById('tab-ubicaciones')
    };
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        const tabName = tab.dataset.tab;
        Object.keys(sections).forEach(key => sections[key].style.display = (key === tabName) ? 'block' : 'none');
      });
    });
  </script>
</body>
</html>
